(this.webpackJsonpStrangersThings=this.webpackJsonpStrangersThings||[]).push([[0],{32:function(e,t,s){},33:function(e,t,s){"use strict";s.r(t);var n=s(2),c=s(1),r=s(17),a=s.n(r),o=s(8),i=s(3),j=s(13),l=s.n(j),u=s(20),b=s(18),h=function(){var e=Object(b.a)(l.a.mark((function e(t){var s,n,c,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.url,n=t.method,c=t.token,r=t.body,e.prev=1,e.next=4,fetch("https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT/"+s,{method:n?n.toUpperCase():"GET",headers:Object(u.a)({"Content-Type":"application/json"},c&&{Authorization:"Bearer "+c}),body:JSON.stringify(r)});case 4:return a=e.sent,e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),d=s(0),O=function(e){var t=e.token,s=e.fetchPosts,r=e.setShowCreatePost,a=e.post,o=Object(c.useState)(a?a.title:""),i=Object(n.a)(o,2),j=i[0],l=i[1],u=Object(c.useState)(a?a.description:""),b=Object(n.a)(u,2),O=b[0],p=b[1],x=Object(c.useState)(a?a.price:""),f=Object(n.a)(x,2),m=f[0],g=f[1],v=Object(c.useState)(a?a.location:""),S=Object(n.a)(v,2),k=S[0],P=S[1],y=Object(c.useState)(!!a&&a.willDeliver),w=Object(n.a)(y,2),C=w[0],T=w[1],E=Object(c.useState)("Fill out the form. Title, Description, and Price are required. Location will default to [On Request] if left empty."),F=Object(n.a)(E,2),D=F[0],A=F[1];return Object(d.jsxs)("form",{className:"PostForm",onSubmit:function(e){e.preventDefault(),h({url:"posts/"+(a?a._id:""),method:a?"PATCH":"POST",token:t,body:{post:{title:j,description:O,price:m,location:k||"[On Request]",willDeliver:C}}}).then((function(e){e.success?(A(e.data.message),s(),a||r()):A(e.error.message)}))},children:[Object(d.jsx)("h2",{children:"Post Form:"}),Object(d.jsx)("input",{required:!0,type:"text",placeholder:"Title",value:j,onChange:function(e){l(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{required:!0,type:"text",placeholder:"Description",value:O,onChange:function(e){p(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{required:!0,type:"text",placeholder:"Price",value:m,onChange:function(e){g(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",placeholder:"Location",value:k,onChange:function(e){P(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"checkbox",checked:C,onChange:function(){T(!C)}}),Object(d.jsx)("label",{htmlFor:"Will Deliver.",children:"Will Deliver."})]}),Object(d.jsx)("p",{children:D}),Object(d.jsx)("button",{type:"submit",disabled:!j||!O||!m,children:"Submit"})]})},p=function(e){var t=e.message;return Object(d.jsx)(d.Fragment,{children:t.fromUser?Object(d.jsxs)("p",{className:"Message",children:[t.fromUser.username,":",t.content," "]}):null})},x=function(e){var t=Object(c.useState)(""),s=Object(n.a)(t,2),r=s[0],a=s[1],o=Object(c.useState)("Enter your message above"),i=Object(n.a)(o,2),j=i[0],l=i[1],u=e.id,b=e.token,O=e.fetchPosts;return Object(d.jsxs)("form",{className:"MessageForm",onSubmit:function(e){e.preventDefault(),h({url:"posts/"+u+"/messages/",method:"POST",token:b,body:{message:{content:r}}}).then((function(e){e.success?(console.log(e),O()):l(e.error.message)}))},children:[Object(d.jsx)("input",{type:"text",placeholder:"Type your message here",value:r,onChange:function(e){a(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("p",{children:j}),Object(d.jsx)("button",{type:"submit",disabled:!r,children:"Submit"})]})},f=function(e){var t=e.post,s=e.token,r=e.fetchPosts,a=Object(c.useState)(!1),o=Object(n.a)(a,2),i=o[0],j=o[1],l=Object(c.useState)(!1),u=Object(n.a)(l,2),b=u[0],f=u[1];return Object(d.jsxs)("div",{className:"Post",children:[t.title?Object(d.jsx)("h2",{children:t.title}):null,t.author.username?Object(d.jsxs)("p",{children:["Seller: ",t.author.username]}):null,t.description?Object(d.jsx)("p",{children:t.description}):null,t.price?Object(d.jsxs)("p",{children:["Price: ",t.price]}):null,t.location?Object(d.jsxs)("p",{children:["Location: ",t.location]}):Object(d.jsx)("p",{children:"Location: [On Request]"}),Object(d.jsxs)("p",{children:["Will Deliver: ",t.willDeliver?"Yes":"No"]}),t.createdAt?Object(d.jsxs)("p",{children:["Created: ",t.createdAt]}):null,t.updatedAt?Object(d.jsxs)("p",{children:["Last updated: ",t.updatedAt]}):null,0!==t.messages.length?Object(d.jsxs)("p",{children:["Messages: ",t.messages.length]}):null,t.isAuthor?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("button",{onClick:function(){f(!b)},children:"Edit"}),b?Object(d.jsx)(O,{token:s,fetchPosts:r,post:t}):null,Object(d.jsx)("button",{onClick:function(){Promise.all([h({url:"posts/"+t._id+"/",method:"DELETE",token:s})]).then((function(){r()}))},children:"Delete"}),Object(d.jsx)("button",{onClick:function(){j(!i)},children:"Show Post Messages"})]}):null,!t.isAuthor&&s?Object(d.jsx)("button",{onClick:function(){j(!i)},children:"Send a message"}):null,i?t.isAuthor?t.messages.map((function(e){return Object(d.jsx)(p,{message:e},e._id)})):Object(d.jsx)(x,{token:s,id:t._id,fetchPosts:r}):null]})},m=function(e){var t=Object(c.useState)([]),s=Object(n.a)(t,2),r=s[0],a=s[1],o=Object(c.useState)(""),i=Object(n.a)(o,2),j=i[0],l=i[1],u=Object(c.useState)(r),b=Object(n.a)(u,2),p=b[0],x=b[1],m=e.token,g=Object(c.useState)(!1),v=Object(n.a)(g,2),S=v[0],k=v[1],P=function(){Promise.all([h({url:"posts/",token:m})]).then((function(e){var t=Object(n.a)(e,1)[0];a(t.data.posts)}))};return Object(c.useEffect)((function(){P()}),[]),Object(c.useEffect)((function(){x(r.filter((function(e){return e.title.includes(j)||e.description.includes(j)||e.author.username.includes(j)||e.price.includes(j)||e.location.includes(j)})))}),[j,r]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("input",{type:"text",placeholder:"Search Posts",value:j,onChange:function(e){l(e.target.value)}}),m?Object(d.jsx)("h2",{onClick:function(){k(!S)},children:"Show/Hide Post form"}):null,S?Object(d.jsx)(O,{token:m,fetchPosts:P,setShowCreatePost:k}):null,Object(d.jsx)("div",{children:p.map((function(e){return Object(d.jsx)(f,{post:e,fetchPosts:P,token:m},e._id)}))})]})},g=function(e){var t=e.setToken,s=e.setUser,r=e.type,a=Object(c.useState)(""),i=Object(n.a)(a,2),j=i[0],l=i[1],u=Object(c.useState)(""),b=Object(n.a)(u,2),O=b[0],p=b[1],x=Object(c.useState)(""),f=Object(n.a)(x,2),m=f[0],g=f[1],v=Object(c.useState)("Enter username and password to "+r+"."),S=Object(n.a)(v,2),k=S[0],P=S[1],y=Object(c.useState)(!0),w=Object(n.a)(y,2),C=w[0],T=w[1];return Object(c.useEffect)((function(){if(m)if(m!==O){for(var e="Password match o=matching character, x=wrong character, _=missing character, *=extra character:",t=0;t<O.length||t<m.length;t++)t<O.length?t<m.length?O.charAt(t)===m.charAt(t)?e+="o":e+="x":e+="_":e+="*";P(e)}else P("Passwords match!");else P("Enter username and password to "+r+".")}),[m]),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),h({url:"users/"+r,method:"POST",body:{user:{username:j,password:O}}}).then((function(e){e.success?(t(e.data.token),P(e.data.message),s(j)):P(e.error.message)}))},children:[Object(d.jsx)("h2",{children:Object(d.jsx)(o.b,{to:"/account/"+r+"/",children:r.toUpperCase()})}),Object(d.jsx)("input",{required:!0,type:"text",placeholder:"Username",value:j,onChange:function(e){l(e.target.value)}}),Object(d.jsx)("input",{required:!0,type:C?"password":"text",placeholder:"Password",value:O,onChange:function(e){p(e.target.value)}}),Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"checkbox",checked:C,value:C,onChange:function(){T(!C)}}),Object(d.jsx)("label",{htmlFor:"Hide Password",children:"Hide Password"})]}),"register"===r?Object(d.jsx)("input",{required:!0,type:"password",placeholder:"Confirm Password",value:m,onChange:function(e){g(e.target.value)}}):null,Object(d.jsx)("p",{children:k}),Object(d.jsx)("button",{type:"submit",disabled:!j||!O||"register"===r&&O!==m,children:r})]})},v=function(e){var t=e.setToken,s=e.setUser,n=Object(i.f)()[0];return Object(d.jsxs)(d.Fragment,{children:["register/"!==n?Object(d.jsx)(g,{setToken:t,setUser:s,type:"login"}):null,"login/"!==n?Object(d.jsx)(g,{setToken:t,setUser:s,type:"register"}):null]})},S=function(e){var t=e.user,s=e.setToken,n=e.setUser;return Object(d.jsxs)("h2",{className:"NavBar",children:[Object(d.jsx)(o.c,{to:"/",children:"Home"}),Object(d.jsx)(o.c,{to:"/posts/",children:"Posts"}),Object(d.jsx)(o.c,{to:"/account/",children:"Account"}),t?Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(o.c,{to:"/profile/",children:"Profile"})}):null,t?Object(d.jsxs)(d.Fragment,{children:["Logged in as ",t,Object(d.jsx)("span",{onClick:function(){s(""),n("")},children:"Logout"})]}):null]})},k=function(e){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{children:"Welcome to Strangers Things."}),e.user?Object(d.jsx)("h1",{children:e.user}):null]})},P=function(e){var t=e.token,s=Object(c.useState)([]),r=Object(n.a)(s,2),a=r[0],o=r[1],i=Object(c.useState)([]),j=Object(n.a)(i,2),l=j[0],u=j[1];return Object(c.useEffect)((function(){t?Promise.all([h({url:"users/me/",token:t})]).then((function(e){var t=Object(n.a)(e,1)[0];o(t.data.messages),u(t.data.posts)})):(o([]),u([]))}),[t]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{children:"My Messages:"}),a.map((function(e,t){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("h2",{children:["Post:",e.post.title]},t),Object(d.jsx)(p,{message:e},e._id)]})})),Object(d.jsx)("h1",{children:"My Posts:"}),l.map((function(e){return e.active?Object(d.jsx)(f,{post:e},e._id):null}))]})},y=function(){var e=Object(i.f)()[0];return Object(d.jsxs)("h1",{children:["404 Error: Page for ",e," does not exist."]})},w=(s(32),function(){var e=Object(c.useState)(""),t=Object(n.a)(e,2),s=t[0],r=t[1],a=Object(c.useState)(""),j=Object(n.a)(a,2),l=j[0],u=j[1];return Object(d.jsxs)(o.a,{children:[Object(d.jsx)(S,{user:l,setToken:r,setUser:u}),Object(d.jsxs)(i.c,{children:[Object(d.jsx)(i.a,{exact:!0,path:"/",children:Object(d.jsx)(k,{user:l})}),Object(d.jsx)(i.a,{exact:!0,path:"/profile/",children:Object(d.jsx)(P,{token:s})}),Object(d.jsx)(i.a,{exact:!0,path:"/posts/",children:Object(d.jsx)(m,{token:s,user:l})}),Object(d.jsx)(i.a,{exact:!0,path:["/account/*/","/account/"],children:Object(d.jsx)(v,{setToken:r,setUser:u})}),Object(d.jsx)(i.a,{path:"/*",children:Object(d.jsx)(y,{})})]})]})});a.a.render(Object(d.jsx)(w,{}),document.getElementById("app"))}},[[33,1,2]]]);
//# sourceMappingURL=main.2776576f.chunk.js.map